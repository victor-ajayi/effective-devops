# Effective DevOps тестовое задание

Простое веб-приложение на Flask с обратным прокси-сервером Nginx, развернутое с помощью Docker и Docker Compose.

## Архитектура

Приложение состоит из двух сервисов:

```
┌─────────────┐
│   Client    │
│  (Browser)  │
└──────┬──────┘
       │ HTTP (port 80)
       ▼
┌─────────────┐      ┌─────────────┐
│    Nginx    │─────▶│   Backend   │
│  (Proxy)    │      │   (Flask)   │
│  Port 80    │      │  Port 8080  │
└─────────────┘      └─────────────┘
       │                    │
       └────────────────────┘
            Docker Network
            (server)
```

### Компоненты

1. **Backend**
   - Python 3.13 на базе Alpine Linux
   - Простое Flask HTTP-сервер на порту 8080
   - Отвечает на `/` текстом: `"Hello from Effective Mobile!"`
   - Доступен только внутри Docker-сети

2. **Nginx**
   - Официальный образ nginx:alpine
   - Принимает HTTP-запросы на порту 80
   - Проксирует запросы на backend-сервис
   - Публикует только порт 80 на хост

3. **Docker Network**
   - Изолированная сеть `server` (bridge driver)
   - Обеспечивает взаимодействие между контейнерами

## Использованные технологии

- **Python 3.13** - язык программирования
- **Flask** - веб-фреймворк
- **Nginx** - обратный прокси-сервер
- **Docker** - контейнеризация
- **Docker Compose** - оркестрация контейнеров
- **uv** - быстрый менеджер пакетов Python

## Запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/victor-ajayi/effective-devops
cd effective-devops
```

### 2. Настройка переменных окружения (опционально)

Создайте файл `.env` в корне проекта (если нужно изменить порт):

```bash
NGINX_PORT=80
BACKEND_PORT=8080
```

### 3. Сборка и запуск контейнеров

```bash
docker compose up --build
```

Эта команда:
- Соберет образ backend-сервиса
- Запустит оба контейнера (backend и nginx)
- Подключит их к сети `server`

### 4. Проверка работоспособности

В новом терминале выполните:

```bash
curl http://localhost
```

**Ожидаемый ответ:**
```
Hello from Effective Mobile!
```

## Структура проекта

```
effective-devops/
├── backend/
│   ├── app.py          # Flask приложение
│   └── Dockerfile      # Dockerfile для backend
├── nginx/
│   └── nginx.conf      # Конфигурация Nginx
├── docker-compose.yml  # Конфигурация Docker Compose
├── pyproject.toml      # Зависимости Python проекта
└── README.md          # Документация
```

## Особенности реализации

### Безопасность
- Backend запускается от непривилегированного пользователя
- Backend недоступен с хоста (только внутри Docker-сети)
- Nginx конфигурация монтируется в режиме только для чтения (`:ro`)

### Оптимизация
- Многостадийная сборка (multistage build)
- Использование Alpine образов
- Использование `uv` для быстрой установки зависимостей

### Сетевая изоляция
- Отдельная Docker-сеть `server` для изоляции сервисов
- Backend использует `expose` (не публикует порт наружу)
- Взаимодействие между сервисами по именам контейнеров
